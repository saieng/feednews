# FeedNews 项目产品需求文档 (PRD)

## 1. 项目概述

FeedNews 是一个现代化的响应式新闻展示平台，采用前后端分离架构。项目旨在复现 feedmusic.com 的精致动效和交互体验，同时提供完整的新闻内容管理系统。前端基于 Vue3 + TailwindCSS 构建，后端采用 FastAPI + PostgreSQL，全部通过 Docker Compose 容器化部署。

## 2. 核心目标

- **极致用户体验**：复刻 www.feedmusic.com 的互动动效和丝滑滚动效果
- **响应式设计**：完美适配 PC、平板、手机等多设备场景
- **内容管理**：提供直观易用的后台管理系统，支持新闻的 CRUD 操作
- **用户系统**：完整的注册登录体系，支持用户权限管理
- **技术现代化**：采用最新技术栈，确保高性能和可维护性

## 3. 用户与角色

### 3.1 访客用户 (Guest)

- 浏览新闻内容
- 查看首页介绍和新闻列表
- 无法访问管理后台

### 3.2 注册用户 (Registered User)

- 拥有访客所有权限
- 可登录管理后台
- 可创建、编辑、删除自己发布的新闻
- 新闻自动关联创建者用户名

### 3.3 管理员用户 (Admin)

- 拥有注册用户所有权限
- 可管理所有用户的新闻内容
- 具备系统管理权限

## 4. 功能性需求

### 4.1 前端功能需求

#### 4.1.1 第一屏 - Introduction

**动态背景效果**

- 实现多层视差滚动背景，营造深度感
- 背景元素随滚动速度差异化移动
- 支持渐变色彩过渡动画
- 背景粒子系统或几何图形缓慢浮动

**文字滚动效果**

- 主标题文字逐个字母淡入动画
- 副标题文字从下往上滑入效果
- 滚动时文字透明度变化
- 文字阴影跟随鼠标移动产生微妙位移

**顶部导航栏**

- 固定在页面顶部，滚动时背景透明度变化
- 两个分页快捷按钮：Introduction、News
- 当前页面指示器（进度条样式）
- 登录/注册按钮（未登录状态）
- 用户信息显示：用户名 + 退出登录按钮（已登录状态）
- 移动端汉堡菜单，支持手势滑动关闭

#### 4.1.2 第二屏 - News

**响应式网格布局**

- PC 端：每行 3 个新闻卡片，间距 24px
- 平板端：每行 2 个新闻卡片，间距 20px
- 移动端：每行 1 个新闻卡片，全宽显示
- 断点设置：移动端 <768px，平板 768px-1024px，PC >1024px

**新闻卡片设计**

- 图片区域：16:9 比例，支持占位图和实际图片
- 标题：加粗显示，最多 2 行文字，超出省略号
- 描述：限制 2 行文字，超出显示省略号
- 创作者标签："By: {username}"格式，使用创建者用户名
- 悬停效果：卡片轻微上浮，阴影加深
- 点击效果：整卡可点击，跳转到新闻详情页

**加载更多功能**

- 默认显示 2 行新闻（PC 端 6 条，移动端 2 条）
- "更多"按钮位于列表底部中央
- 点击后每次加载额外 1 行新闻
- 加载状态显示旋转动画
- 无更多内容时按钮变为"已加载全部"

#### 4.1.3 屏幕切换效果

**滚动触发切换**

- 监听鼠标滚轮事件，支持平滑滚动
- 滚动超过 50%视口高度时自动切换
- 滚动方向检测，防止误触
- 移动端支持触摸滑动切换

**导航栏快捷切换**

- 点击导航按钮立即切换到对应屏幕
- 切换动画：当前屏幕向上滑出，新屏幕从下滑入
- 动画时长：600ms，使用 ease-in-out 缓动函数
- 导航栏进度条跟随切换进度更新

### 4.2 后端功能需求

#### 4.2.1 用户系统

**用户注册**

- 接口：POST /api/auth/register
- 字段：username（唯一）、email、password
- 密码加密：使用 bcrypt 进行哈希处理
- 邮箱验证：发送验证邮件（可选增强功能）
- 用户名规则：3-20 字符，仅支持字母、数字、下划线

**用户登录**

- 接口：POST /api/auth/login
- 支持用户名或邮箱登录
- JWT Token 生成，有效期 24 小时
- 登录状态保持：httpOnly cookie 存储 token
- 登录失败限制：5 次失败后锁定 15 分钟

**用户登出**

- 接口：POST /api/auth/logout
- 清除客户端 cookie
- 服务端 token 黑名单处理

#### 4.2.2 新闻管理

**新闻模型**

- 字段：id、title、description、image_url、creator_id、created_at、updated_at
- creator_id 关联用户表，自动记录创建者
- 软删除机制，保留历史记录

**创建新闻**

- 接口：POST /api/news
- 需要登录验证
- 支持图片上传（本地存储或云存储）
- 字段验证：标题必填，最长 100 字符；描述必填，最长 500 字符

**编辑新闻**

- 接口：PUT /api/news/{id}
- 仅创建者可编辑（管理员除外）
- 支持增量更新，只更新提供的字段
- 记录更新时间戳

**删除新闻**

- 接口：DELETE /api/news/{id}
- 软删除，设置 deleted_at 时间戳
- 仅创建者可删除（管理员除外）

**新闻列表**

- 接口：GET /api/news
- 支持分页：page、limit 参数
- 支持搜索：q 参数搜索标题和描述
- 默认排序：创建时间倒序
- 响应格式：包含总数量、当前页、数据列表

#### 4.2.3 管理后台

**登录页面**

- 简洁的登录表单设计
- 实时表单验证反馈
- 记住我功能（7 天有效期）
- 忘记密码链接（预留功能）

**新闻管理列表**

- 表格展示：标题、创建者、创建时间、操作按钮
- 分页导航：每页 10 条，显示总页数
- 搜索功能：按标题模糊搜索
- 批量操作：批量删除（管理员功能）
- 排序功能：可按创建时间、标题排序

**新闻编辑表单**

- 富文本编辑器：支持标题、描述编辑
- 图片上传：拖拽上传、预览功能
- 实时保存草稿：防止意外丢失
- 表单验证：实时提示错误信息

## 5. 非功能性需求

### 5.1 响应式设计

- **断点策略**：

  - 超小屏幕：< 640px（手机竖屏）
  - 小屏幕：640px - 768px（手机横屏）
  - 中等屏幕：768px - 1024px（平板）
  - 大屏幕：1024px - 1280px（小型笔记本）
  - 超大屏幕：> 1280px（桌面显示器）

- **字体响应式**：

  - 使用 clamp()函数实现字体大小平滑过渡
  - 标题：clamp(1.5rem, 4vw, 3rem)
  - 正文：clamp(0.875rem, 2vw, 1.125rem)

- **图片响应式**：
  - 使用 srcset 提供多分辨率图片
  - 懒加载实现，首屏内容优先加载
  - WebP 格式优先，JPEG 回退

### 5.2 性能要求

- **加载性能**：

  - 首屏加载时间 < 2 秒（3G 网络）
  - 懒加载实现，按需加载图片
  - 代码分割，路由级别拆分
  - CDN 加速静态资源

- **运行时性能**：
  - 滚动帧率 > 60fps
  - 动画使用 transform 和 opacity 属性
  - 防抖和节流优化滚动事件
  - 虚拟滚动处理大量新闻数据

### 5.3 安全性

- **前端安全**：

  - XSS 防护：用户输入内容转义
  - CSRF 防护：使用双重 cookie 验证
  - 内容安全策略（CSP）配置

- **后端安全**：
  - SQL 注入防护：使用 ORM 参数化查询
  - 密码安全：bcrypt 加密 + 盐值
  - 速率限制：API 调用频率限制
  - HTTPS 强制使用

### 5.4 可维护性

- **代码规范**：

  - 前端：遵循 Vue3 风格指南
  - 后端：遵循 PEP8 规范
  - 提交信息：使用 Conventional Commits

- **文档要求**：
  - API 文档：自动生成 OpenAPI 规范
  - 组件文档：Storybook 展示
  - 部署文档：详细的 Docker 配置说明

## 6. 交互逻辑核心参考 (Analysis of feedmusic.com)

### 6.1 首页背景动效

**视差滚动机制**

- 多层背景设计：远景（缓慢移动）+ 中景（正常速度）+ 近景（快速移动）
- 滚动系数计算：远景 0.3x、中景 0.7x、近景 1.2x
- 平滑过渡：使用 requestAnimationFrame 优化性能
- 色彩动画：HSL 色彩空间循环渐变，周期 30 秒

**文字动画序列**

- 入场动画：文字从下方滑入 + 透明度渐变，持续 800ms
- 滚动响应：文字位置随滚动偏移，产生 3D 透视效果
- 鼠标跟随：文字阴影根据鼠标位置动态调整
- 退出动画：向上淡出，持续 400ms

### 6.2 导航与滚动进度条

**进度条实现**

- 双屏设计：总高度 200vh，每屏 100vh
- 进度计算：scrollTop / (totalHeight - viewportHeight) \* 100%
- 平滑动画：使用 transform: scaleX()实现宽度变化
- 过渡效果：进度变化时 200ms 的 ease-out 动画

**导航交互**

- 悬停效果：按钮背景色渐变，图标旋转
- 点击反馈：按钮缩小 95%再恢复，提供触觉反馈
- 状态指示：当前页面按钮高亮，其他按钮半透明
- 移动端适配：底部固定导航栏，手势滑动切换

### 6.3 页面切换效果

**滚动切换逻辑**

- 阈值检测：滚动超过 40%视口高度触发切换
- 方向判断：根据滚动 deltaY 正负值确定方向
- 防抖处理：300ms 内只触发一次切换
- 边界检测：防止在第一屏向上或最后一屏向下滚动

**动画实现**

- 使用 CSS transform: translateY()实现滑动效果
- 硬件加速：will-change: transform 属性优化
- 同步动画：导航栏进度条与页面切换同步更新
- 回弹效果：到达边界时的弹性动画

### 6.4 响应式交互细节

**移动端优化**

- 触摸手势：支持左右滑动切换页面
- 惯性滚动：模拟原生滚动体验
- 双击缩放：图片支持双击查看大图
- 横屏适配：自动调整布局方向

**性能优化**

- 防抖处理：滚动事件 16ms 节流
- 懒加载：图片进入视口前 100px 开始加载
- 内存管理：离开视口的动画元素暂停渲染
- 电池优化：低电量模式减少动画复杂度
